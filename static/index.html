<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Patent Search - Law & CS Group C</title>
  <!-- CSS only -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" type="text/css" href="style_form.css"/>
</head>
<body>
  <nav class="navbar navbar-light bg-light">
    <div class="container-fluid">
      <span class="navbar-brand mb-0 h1">Patent Search - Law & CS Group C</span>
    </div>
  </nav>

  <div class="container contentMain">

<div class="page" id="page_search">
  <br /><br /><br />
  <center>
    <h1>
      <!-- <span class="rainbow">p a t e n t s e a r c h</span> -->
      Patent Search
    </h1>
    <form id="form_search" method="POST">
      <textarea rows="5" cols="60" name="q" placeholder="Enter a description of your patent..."></textarea> </br>
      <input type="checkbox" id="vehicle1" name="vehicle1" value="Bike"> I understand & agree to the Terms of Service and Privacy Policy <br /><br />
      <!-- <input name="q" type="text"><br /> -->
      <button class="btn btn-primary mb-3" type="submit" value="Submit">Search</button>
    </form>
  </center>

</div>


<div class="page" id="page_loading">
  <img src="spinner.gif" class="img_spinner" />
</div>

<div class="page" id="page_results">
  <h1>Showing top 10 matches:</h1>
  <div class="results">
    <div class="searchResult">
      <span class="resultSimilarity">68%</span>
      <div class="resultInfo">
        <div class="resultTitle"><a href="?test">Game device and system using such game device</a></div>
        <div class="resultSubtitle">TW300973B | 1997-03-21 | NINTENDO CO LTD</div>
        <div class="resultText">...which can modulate operating data and execute image processing includes:CPU for executing the image processing; memory device for accessing data;<b>receiving mechanism for receiving and modulating the data</b>; timing memoryfor timing; data processor for executing data process; sending mechanism...</div>
      </div>
    </div>
    <div class="searchResult">
      <span class="resultSimilarity">68%</span>
      <div class="resultInfo">
        <div class="resultTitle"><a href="?test">Game device and system using such game device</a></div>
        <div class="resultSubtitle">TW300973B | 1997-03-21 | NINTENDO CO LTD</div>
        <div class="resultText">...which can modulate operating data and execute image processing includes:CPU for executing the image processing; memory device for accessing data;<b>receiving mechanism for receiving and modulating the data</b>; timing memoryfor timing; data processor for executing data process; sending mechanism...</div>
      </div>
    </div>
    <div class="searchResult">
      <span class="resultSimilarity">68%</span>
      <div class="resultInfo">
        <div class="resultTitle"><a href="?test">Game device and system using such game device</a></div>
        <div class="resultSubtitle">TW300973B | 1997-03-21 | NINTENDO CO LTD</div>
        <div class="resultText">...which can modulate operating data and execute image processing includes:CPU for executing the image processing; memory device for accessing data;<b>receiving mechanism for receiving and modulating the data</b>; timing memoryfor timing; data processor for executing data process; sending mechanism...</div>
      </div>
    </div>
    <div class="searchResult">
      <span class="resultSimilarity">68%</span>
      <div class="resultInfo">
        <div class="resultTitle"><a href="?test">Game device and system using such game device</a></div>
        <div class="resultSubtitle">TW300973B | 1997-03-21 | NINTENDO CO LTD</div>
        <div class="resultText">...which can modulate operating data and execute image processing includes:CPU for executing the image processing; memory device for accessing data;<b>receiving mechanism for receiving and modulating the data</b>; timing memoryfor timing; data processor for executing data process; sending mechanism...</div>
      </div>
    </div>


  </div>

</div>

  </div>
</body>
<script>

// String.prototype.toProperCase = function () {
//     return this.replace(/\w\S*/g, function(txt){return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();});
// };

var currentPage = 'search';
// var hash = window.location.hash.substr(1);
// if(hash!==undefined && hash!==""){
//   currentPage = hash;
// }

// const numPages = $('.page').length;

function showPage(newPage = currentPage){
  $('.page').hide();
  $('#page_'+newPage).show();

  // $('#btnNext').prop('disabled', currentPage==numPages-1);
  // $('#btnPrev').prop('disabled', currentPage==0);

  // window.location.hash = currentPage;
}
showPage();

// $('#btnNext').click(_=>{ currentPage+=1; showPage()});
// $('#btnPrev').click(_=>{ currentPage-=1; showPage()});

function lerp(a,b,t){ return a + (b-a)*t;}


$('#form_search').submit(ev=>{
  ev.preventDefault();

  var data = {}; $('#form_search').serializeArray().map(item => data[item['name']] = item['value']);

  showPage('loading');

  $.ajax({
    type: 'POST',
    url: '/api/search',
    data: data,
    // dataType: 'json',
    // contentType: 'application/json',
    success: response => {
      console.log(response);

      var resultsHtml = '';

      response.forEach(result => {
        const hue = lerp(100,0,result['similarity']);

        newElem = `
<div class="searchResult">
  <span class="resultSimilarity" style="color:hsl(${hue}deg,92%,40%">${Math.round(result['similarity']*100)}%</span>
  <div class="resultInfo">
    <!--<div class="resultTitle"><a href="/patent?id=${result['patent']['id']}">${result['patent']['title']}</a></div>-->
    <div class="resultTitle"><a target="_blank" href="https://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-bool.html&r=1&f=G&l=50&co1=AND&d=PTXT&s1=${result['patent']['id']}">${result['patent']['title']}</a></div>
    <div class="resultSubtitle">${result['patent']['id']} | ${result['patent']['date']} | ${result['patent']['applicant']}</div>
    <div class="resultText">${result['relevantText']}</div>
  </div>
</div>
        `;

        resultsHtml += newElem;
      });

      $('.results').html(resultsHtml);
      showPage('results');

    },
    error: e => {console.log(e);}
  })
});
</script>
</html>
